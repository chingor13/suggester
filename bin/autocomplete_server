#!/usr/bin/env ruby

$LOAD_PATH.unshift File.expand_path(File.dirname(__FILE__) + '/../lib')
begin
  require 'vegas'
rescue LoadError
  require 'rubygems'
  require 'vegas'
end
require 'autocomplete'

require 'ruby-debug'

Vegas::Runner.new(Autocomplete::Server, 'autocomplete_server', {
  :before_run => lambda {|v|
    path = (ENV['AUTOCOMPLETE_CONFIG'] || v.args.first)
    load path.to_s.strip if path
  }
}) do |runner, opts, app|
  opts.on('-R REFRESH_RATE', "--refresh-rate REFRESH_RATE", "set the automatic refresh rate (in minutes)") {|refresh_rate|
    Autocomplete::Server.set_refresh_rate(refresh_rate)
  }
end
